---
name: 'Check Repository Setup Status'
description: 'Determines if repository has been configured (not a template)'
outputs:
  is-setup:
    description: 'Whether the repository has been set up (true/false)'
    value: ${{ steps.check.outputs.is-setup }}
  should-skip:
    description: 'Whether workflows should be skipped (true/false)'
    value: ${{ steps.check.outputs.should-skip }}

runs:
  using: 'composite'
  steps:
    - name: Check repository setup status
      id: check
      shell: bash
      run: |
        # Check if PROJECT_NAME secret exists (set by setup script)
        if [ -n "${{ env.PROJECT_NAME }}" ] || [ -n "${{ env.SETUP_COMPLETE }}" ]; then
          echo "is-setup=true" >> $GITHUB_OUTPUT
          echo "should-skip=false" >> $GITHUB_OUTPUT
          echo "✅ Repository is configured and ready"
        elif [ -f "platform/config.json" ]; then
          echo "is-setup=true" >> $GITHUB_OUTPUT
          echo "should-skip=false" >> $GITHUB_OUTPUT
          echo "✅ Repository is configured (config.json exists)"
        else
          echo "is-setup=false" >> $GITHUB_OUTPUT
          echo "should-skip=true" >> $GITHUB_OUTPUT
          echo "⚠️ Repository appears to be a template - workflows will be skipped"
          echo "ℹ️ Run ./setup.ts to configure this repository"
        fi