apiVersion: velero.io/v1
kind: Schedule
metadata:
  name: weekly-full-backup
  namespace: velero
spec:
  # Run weekly on Sunday at 1 AM UTC
  schedule: "0 1 * * 0"
  template:
    # Include all namespaces
    includedNamespaces:
    - keycloak
    - mattermost
    - nextcloud
    - mailu
    - velero
    - cert-manager
    - kong-system
    - external-dns
    
    # Exclude system and temporary resources
    excludedResources:
    - events
    - events.events.k8s.io
    
    # Backup persistent volumes
    defaultVolumesToRestic: true
    
    # Retention policy - keep for 12 weeks (3 months)
    ttl: "2016h"
    
    # Storage location
    storageLocation: default
    
    # Include cluster-scoped resources
    includeClusterResources: true
    
    # Backup labels for identification
    metadata:
      labels:
        backup-type: "weekly"
        backup-scope: "full-cluster"