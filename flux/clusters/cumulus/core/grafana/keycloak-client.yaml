apiVersion: k8s.keycloak.org/v2alpha1
kind: KeycloakClient
metadata:
  name: grafana-client
  namespace: grafana
spec:
  realmSelector:
    matchLabels:
      realm: happyvertical
  client:
    clientId: grafana
    name: Grafana
    description: Grafana dashboards
    protocol: openid-connect
    clientAuthenticatorType: client-secret
    publicClient: false
    standardFlowEnabled: true
    directAccessGrantsEnabled: false
    implicitFlowEnabled: false
    serviceAccountsEnabled: false
    redirectUris:
      - https://grafana.{{ (datasource "config").domain.primary }}/oauth2/callback
    webOrigins:
      - https://grafana.{{ (datasource "config").domain.primary }}
    defaultClientScopes:
      - openid
      - email
      - profile
    attributes:
      backchannel.logout.session.required: "true"
      backchannel.logout.revoke.offline.tokens: "false"
  secretName: grafana-keycloak-client-secret