apiVersion: v1
kind: ConfigMap
metadata:
  name: jaeger-keycloak-setup
  namespace: jaeger
data:
  instructions: |
    Keycloak Setup Instructions for Jaeger Integration
    =================================================
    
    1. Access Keycloak admin console at https://auth.{{ (datasource "config").domain.primary }}
    
    2. Create a new client for Jaeger in the "happyvertical" realm:
       - Client ID: jaeger
       - Client Protocol: openid-connect
       - Access Type: confidential
       - Valid Redirect URIs: 
         - https://tracing.{{ (datasource "config").domain.primary }}/oauth2/callback
       - Web Origins: https://tracing.{{ (datasource "config").domain.primary }}
    
    3. Configure client scopes:
       - Default Client Scopes: openid, email, profile
    
    4. Get the client secret from the Credentials tab
    
    5. Update the jaeger-oauth2-proxy secret with the actual client secret:
       kubectl edit secret jaeger-oauth2-proxy -n jaeger
    
    6. Generate a 32-character random cookie secret:
       openssl rand -base64 32 | head -c 32
       Update the cookie-secret in the same secret
    
    Note: Jaeger UI will be accessible at https://tracing.{{ (datasource "config").domain.primary }}
    after successful Keycloak authentication.