# Secret templates for Mailu (OAuth2 Proxy and Database connections)
# This file is processed by GitHub Actions to generate encrypted secrets
# Required GitHub Secrets:
# - MAILU_OAUTH2_CLIENT_ID
# - MAILU_OAUTH2_CLIENT_SECRET
# - MAILU_OAUTH2_COOKIE_SECRET
# - MAILU_PROD_DB_PASSWORD
# - BACKUP_SPACES_ACCESS_KEY
# - BACKUP_SPACES_SECRET_KEY
# - AWS_SES_ACCESS_KEY_ID
# - AWS_SES_SECRET_ACCESS_KEY
# - SES_SMTP_USERNAME
# - SES_SMTP_PASSWORD

---
# OAuth2 Proxy secrets
apiVersion: v1
kind: Secret
metadata:
  name: oauth2-proxy
  namespace: mailu
type: Opaque
stringData:
  client-id: "{{ .Env.MAILU_OAUTH2_CLIENT_ID }}"
  client-secret: "{{ .Env.MAILU_OAUTH2_CLIENT_SECRET }}"
  cookie-secret: "{{ .Env.MAILU_OAUTH2_COOKIE_SECRET }}"

---
# PostgreSQL credentials for CloudNativePG cluster
apiVersion: v1
kind: Secret
metadata:
  name: mailu-postgres-credentials
  namespace: mailu
type: kubernetes.io/basic-auth
stringData:
  username: mailu
  password: "{{ .Env.MAILU_PROD_DB_PASSWORD }}"

---
# Backup credentials for PostgreSQL (DigitalOcean Spaces)
apiVersion: v1
kind: Secret
metadata:
  name: mailu-postgres-backup-credentials
  namespace: mailu
type: Opaque
stringData:
  ACCESS_KEY_ID: "{{ .Env.BACKUP_SPACES_ACCESS_KEY }}"
  SECRET_ACCESS_KEY: "{{ .Env.BACKUP_SPACES_SECRET_KEY }}"

---
# AWS SES SMTP credentials for outgoing mail relay
apiVersion: v1
kind: Secret
metadata:
  name: mailu-ses-credentials
  namespace: mailu
type: Opaque
stringData:
  RELAY_HOST: "email-smtp.${AWS_SES_REGION}.amazonaws.com:587"
  RELAY_USER: "${SES_SMTP_USERNAME}"
  RELAY_PASSWORD: "${SES_SMTP_PASSWORD}"
  AWS_ACCESS_KEY_ID: "${AWS_SES_ACCESS_KEY_ID}"
  AWS_SECRET_ACCESS_KEY: "${AWS_SES_SECRET_ACCESS_KEY}"
  AWS_REGION: "${AWS_SES_REGION}"