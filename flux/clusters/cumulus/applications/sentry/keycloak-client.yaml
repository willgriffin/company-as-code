apiVersion: k8s.keycloak.org/v2alpha1
kind: KeycloakClient
metadata:
  name: sentry-client
  namespace: sentry
spec:
  realmSelector:
    matchLabels:
      realm: happyvertical
  client:
    clientId: sentry
    name: Sentry
    description: Error tracking
    protocol: openid-connect
    clientAuthenticatorType: client-secret
    publicClient: false
    standardFlowEnabled: true
    directAccessGrantsEnabled: false
    implicitFlowEnabled: false
    serviceAccountsEnabled: false
    redirectUris:
      - https://sentry.{{ (datasource "config").domain.primary }}/oauth2/callback
    webOrigins:
      - https://sentry.{{ (datasource "config").domain.primary }}
    defaultClientScopes:
      - openid
      - email
      - profile
    attributes:
      backchannel.logout.session.required: "true"
      backchannel.logout.revoke.offline.tokens: "false"
  secretName: sentry-keycloak-client-secret